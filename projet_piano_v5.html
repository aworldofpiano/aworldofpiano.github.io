<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8' />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Le monde en piano</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
        crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js" integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA=="
        crossorigin=""></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.2/css/bulma.min.css">
    <link href="https://fonts.googleapis.com/css?family=Quicksand" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="semantic/dist/semantic.min.css">

    <script src="https://unpkg.com/parse/dist/parse.min.js"></script>


    <script
    src="https://code.jquery.com/jquery-3.1.1.min.js"
    integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
    crossorigin="anonymous"></script>
    <script src="semantic/dist/semantic.min.js"></script>
    <script src="jquery_projet_piano.js"></script>




    <style>

        body {
            background-color: rgb(197, 199, 255);
            font-family: 'Quicksand', sans-serif;
        }

        .modal {
            z-index: 10000
        }

        .modal-content {
            min-height: 200px;
            PADDING: 10px;
            background: #fafafa;
        }

        .uiheader {
            color: rgb(61, 10, 10);
            text-align: center;
            font-size: 500%;
            font-family: 'quicksand', sans-serif;
            font-weight: bolder;
            margin-bottom: 0%;
        }

        .uiheader2 {
            text-align: center;
            font-family: 'quicksand';
            font-size: 200%;
            margin-top: 0%;
            margin-bottom:10%;
            font-weight: 300;
        }

        .carte {
            width: 90%;
            height: 750px;
            margin-left: auto;
            margin-right: auto;
            margin-bottom:11%;
            border: solid 5px rgb(17, 12, 54);
            
        }

        .rating {
            display: flex;
            justify-content: space-between;
        }
        .rating a {
            color: #aaa;
            text-decoration: none;
            font-size: 2em;
            transition: color .4s;
            float: right;
        
        }

        .rating a:hover~a,
        .rating a:focus~a {
            color: rgb(255, 240, 28);
            cursor: pointer;
        }
        .toggle-button{background-color:grey;
        font-style:italic;
        margin-left:45%;
        margin-right:auto;
        margin-top:-8%;
        margin-bottom:20%;
        min-height:20px;
        }

        .activated{background-color:rgb(51, 197, 51);opacity:0.5;}
        .header3{font-size:250%;
        margin-left:auto;
        margin-right:auto;
        text-align:left;
        display:inline;
        margin-left:5.5%;
        line-height: 150px;
        }
        .hidden{display:none}
        .welcome{margin-top:1%}
        .logout{margin-left:85%; 
        margin-top:-3.1%}
        .login{margin-top:1%;
        margin-left:2%;margin-right:0%;}
        .signup{margin-top:1%}
        .password-forgotten{margin-bottom:3%; margin-top:3%}
        .yes{margin-left:45%;
        margin-right:auto;
        margin-top:-4%;
        font-style:italic;
        }
        .signin{
        color : rgb(39, 35, 35);
        font-size : 130%;
        margin-left:5%;
        margin-right:auto;
        margin-top:-1%;}

        .active{
        display: inline;
        }
        .icon{
            display:flex;
            
        }

        
        
        
        .bottom{
          background-color:  rgb(197, 199, 255)
        }

        .framboise{
            display:inherit;
            z-index:50000000000000;
        }
        .custom{
            color:green
        }
        
        .leaflet-popup {
            margin-right: 17px;
            min-width:150px;
            min-height:100px;
            font-size:125%;
            font-weight:600;
            font-family:'quicksand',sans-serif;
            color:rgb(71, 42, 214);
        }
        .header13{
        
            color:rgb(54, 31, 31);
            text-align: center;

        }

       
        .popup-button{
            display:block;
            margin:auto;
        }
        .bulma-card{
            max-width: 20%;
            min-height: 150px;
            z-index:50000000;
            margin:auto;
            display:block;
        }

        .sidebar{
            position: fixed;
            top: 51px;
            bottom: 0;
            left: 0;
            z-index: 90000000000;
            display: block;
            padding: 20px;
            overflow-x: hidden;
            overflow-y: auto; /* Scrollable contents if viewport is shorter than content. */
            background-color: #f5f5f5;
            border-right: 1px solid #eee;
            }

        
        body {
    padding: 0em;
}

       
        
    </style>

   
 
</head>

<body>

        

    <div class="modal add-marker-modal">
        <div class="modal-background"></div>
        <div class="modal-content">
            <div class="field">
                <label class="label">Name</label>
                <div class="control">
                    <input class="input marker-name" type="text" placeholder="Text input">
                </div>
            </div>
            <div class="field">
                <label class="label">Message</label>
                <div class="control">
                    <textarea class="textarea marker-description" placeholder="Textarea"></textarea>
                </div>
            </div>
            <div class="field">
                <label class="label">Quelle note ?</label>
                <div class="rating">
                    <div class="stars">
                        <a href="#5" title="Donner 5 étoiles">☆</a>
                        <a href="#4" title="Donner 4 étoiles">☆</a>
                        <a href="#3" title="Donner 3 étoiles">☆</a>
                        <a href="#2" title="Donner 2 étoiles">☆</a>
                        <a href="#1" title="Donner 1 étoile">☆</a>
                    </div>
                </div>
            </div>
            <div class="field is-grouped">
                <div class="control">
                    <button tyê="button" class="button is-link add-marker">Submit</button>
                </div>
                <div class="control">
                    <button class="button is-text">Cancel</button>
                </div>
            </div>
            
        </div>
        <button class="modal-close is-large" aria-label="close"></button>
    </div>


    <div class="modal user-modal">
            <div class="modal-background"></div>
            <div class="modal-content">
                <div class="field">
                        <label class="label">Username</label>
                        <div class="control has-icons-left has-icons-right">
                            <input class="input is-success user-name" type="text" placeholder="Text input" >
                            <span class="icon is-small is-left">
                            <i class="fas fa-user"></i>
                            </span>
                            <span class="icon is-small is-right">
                            <i class="fas fa-check"></i>
                            </span>
                        </div>
                        <p class="help is-success">This username is available</p>
                </div>

                <div class="field2">
                        <label class="label">Email</label>
                        <div class="control has-icons-left has-icons-right">
                          <input class="input is-danger user-email" type="email" placeholder="Email input" value="hello@">
                          <span class="icon is-small is-left">
                            <i class="fas fa-envelope"></i>
                          </span>
                          <span class="icon is-small is-right">
                            <i class="fas fa-exclamation-triangle"></i>
                          </span>
                        </div>
                        <p class="help is-danger">This email is invalid</p>
                      </div>

                <div class="field3">
                    <label class="label">Password ?</label>
                    <div class="control">
                        <input class="input user-password" type="text" placeholder="Text input">
                    </div>
                    </div>

                <div class="field4">
                    <div class="control">
                        <label class="checkbox">
                        <input type="checkbox">
                        I promise not to intentionnally place a wrong marker in order to affect this website's relevance and take note that all new markers are being verified.
                        </label>
                    </div>
                </div>

                <div class="field4 is-grouped">
                        <div class="control">
                          <button class="button is-link submituser">Submit</button>
                        </div>
                        
                </div>

                
            </div>
            <button class="modal-close is-large closebutton-user" aria-label="close"></button>
    </div>


    <div class = "modal login-modal">
            <div class="modal-background"></div>
            <div class = "modal-content">
                    <div class="field">
                            <label class="label">Username</label>
                            <div class="control has-icons-left has-icons-right">
                                <input class="input is-success user-name-login" type="text" placeholder="Text input" >
                                <span class="icon is-small is-left">
                                <i class="fas fa-user"></i>
                                </span>
                                <span class="icon is-small is-right">
                                <i class="fas fa-check"></i>
                                </span>
                            </div>
                            <p class="help is-success">This username is available</p>
                    </div>

                    <div class="field3">
                            <label class="label">Password ?</label>
                            <div class="control">
                                <input class="input user-password-login" type="text" placeholder="Text input">
                            </div>
                    </div>

                    <div class= "button is-small password-forgotten">Password forgotten ?</div>

                    <div class="field4 is-grouped">
                            <div class="control">
                              <button class="button is-link submitlogin">Submit</button>
                            </div>
                            
                    </div>

                    

            </div>
            <button class="modal-close is-large closebutton-login" aria-label="close"></button>



    </div>



    <div class="container">

            
                
        <div class="bulma button popup-button is-info"></div>
                

        <div class="uicontainer"> 
            <a class="button is-light is-outlined is-active signup">Sign Up</a>
            <a class="button is-link login">Login</a> 
            <a class="welcome hidden"></a>
            <a class="button is-danger is-outlined logout hidden">Log Out</a>
            <div class="titre">
                <h1 class='uiheader'>A World of piano</h1>
                <h2 class='uiheader2'> Where to play the piano around the world ? </h2>

            </div>
            
            <div class="ui  right sidebar inverted vertical menu ">
                    <a class="item">
                        1
                    </a>
                    <a class="item">
                        2
                    </a>
                    <a class="item">
                        3
                    </a>
                    </div>
                    <div class="pusher">
                    
                    </div>
                    
            <div id="mapid" div class="carte"> 
                
            </div>

            <div class ="ajouter un piano">
                <h3 class='header3'>Know any place ?  </h3> 
                <a id ="switch" a class="button yes toggle-button" >Click here to add a self-service piano</a>
                <a class = "signin hidden">Log In so you can add pianos !</a>
                <a class = "add icon test button"  data-tooltip="Add users to your feed"></a>
            </div>

            <i class="circular heart icon link" data-content="Hello. This is a wide pop-up which allows for lots of content with additional space. You can fit a lot of words here and the paragraphs will be pretty wide." data-variation="wide"></i>

            
            
    
        

         <script>
                window.onload = function () {

                    
                  

                    Parse.initialize("uW4FPlOmWyjD4qqeXFE867k7ValrkvOa5hl3phMs", "6nYyBiqUP739fvt3cN0kfhgUK1gQxc78vMVORPFJ");
                    Parse.serverURL = "https://parseapi.back4app.com/";
                    var Marker = Parse.Object.extend("Marker");
                    


                 

                    





                    var currentUser2 = Parse.User.current();
                        if (currentUser2) {
                            loggedIn();

                        } else {
                            loggedOut();

                
                          }
    

                    function resetPassword() {

                        var currentUser = Parse.User.current();
                        var currentUserEmail = currentUser.get("email");
                        Parse.User.requestPasswordReset(currentUserEmail, {
                            success: function() {
                                console.log("Password reset request was sent successfully");
                            },
                            error: function(error) {
                                console.log("The login failed with error: " + error.code + " " + error.message);
                            }
                        });
                    }

                    var passwordForgottenButton = document.getElementsByClassName('password-forgotten')[0];
                    passwordForgottenButton.addEventListener('click', resetPassword)


                    var mymap = L.map('mapid').setView([46.342124, 2.603033], 5);

                    var tileStreets = L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
                        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
                        maxZoom: 18,
                        id: 'mapbox.streets',
                        accessToken: 'pk.eyJ1IjoibGFpc3NlcGF1bCIsImEiOiJjam5ocTByd2gwZjU2M3BvM3R5NndidThkIn0.DZIEmZkAfnn7s3fTWv0JHA'
                    }).addTo(mymap)
                    
                    
                
                    var markerleaflet;
                    var nom;
                    

                    const query = new Parse.Query("Marker");
                    query.find().then((markers) => {

                        markers.forEach(function (marker) {
                            
                            
                            var nom = marker.get('nom');
                            var description = marker.get('description');
                            var popupCustom = nom + "<br></br>" +
                            '<div id = "trousse" div class= "header13"></div><div class = "popup-leaflet-description"></div><div class="bulma pompe button popup-button is-info">See more</div>';
                            var customOptions =
                                {
                                'maxWidth': '500',
                                'className' : 'custom'
                                }
                            
                            var tableau = [marker.get('lat'),marker.get('long')];
                            var markerleaflet = L.marker(tableau).bindPopup(popupCustom,customOptions).addTo(mymap);
                            
                            $("div").on("click", '.pompe', function () {
                                
                                $('.ui.sidebar')
                                .sidebar({context:$('#mapid')})
                                .sidebar('setting', 'transition', 'overlay')
                                .sidebar('toggle');
                            });
                        });
                        
                    });
                   
                            

                   

                  
                        
                    

                        

                   
                        
                
                

                    
                 
                    
                    
                    function addSemanticPopup (){

                        

                        var semanticpopup = document.getElementById('semanticbloc');
                        console.log("popup trouvé");
                        var classBefore = semanticpopup.getAttribute('class');
                        if (classBefore.includes('hidden')){
                            var classAfter = classBefore.substring(
                            0,
                            classBefore.indexOf('hidden')
                            );
                            semanticpopup.setAttribute('class', classAfter);
                        } else {
                            var classAfter = classBefore + ' hidden';
                            semanticpopup.setAttribute('class', classAfter);
                        }
                        console.log('okay');
                       
                
                    }
                      
      

                        

                    /*var addPopup = document.getElementsByClassName('carte')[0];
                    console.log("icone chopé")
                        addPopup.addEventListener('dblclick', addSemanticPopup);*/

                        

                        

                        

                        


                         /*var markersff = document.getElementsByClassName("leaflet-marker-icon");
                         console.log(markersff.length);
                         var element1 = markersff.item(3);
                         console.log(element1)

                         Array.prototype.forEach.call(markersff, function(el, i) { 
                                console.log(el.className);
                            });

                        var tableauMarker = [].slice.call(markersff);
                        console.log(tableauMarker)
                            


                        var list= document.getElementsByClassName("leaflet-marker-icon");
                            console.log(list[0].id); //first console output

                            for (var i = 1; i < list.length; i++) {
                                    console.log(list[i]._leaflet_id); //second console output
                                }*/
                        

                        
                        
            
                        
                        
                    
                


                    var lastClickedCoordinates = undefined;

                    function addMarker() {
                        console.log('SUBMIT')
                        var markerNameElement = document.getElementsByClassName('marker-name')[0];
                        var markerName = markerNameElement.value;
                        markerNameElement.value="";
                        console.log(markerName)

                        var markerDescriptionElement = document.getElementsByClassName('marker-description')[0];
                        var markerDescription = markerDescriptionElement.value;
                        markerDescriptionElement.value="";
                        console.log(markerDescription)


                        var tableaubyclick = [lastClickedCoordinates.lat,lastClickedCoordinates.lng]

                    

                        var markerCreatedByClick = new Marker;
                        markerCreatedByClick.set("nom", markerName);
                        markerCreatedByClick.set("lat", lastClickedCoordinates.lat);
                        markerCreatedByClick.set("long", lastClickedCoordinates.lng);
                        markerCreatedByClick.set("description",markerDescription);
                        markerCreatedByClick.save()
                        .then((markerCreatedByClickCreated) => {
                            console.log('ok')
                            var markerleafletbyclick = L.marker(tableaubyclick).addTo(mymap);
                            markerleafletbyclick.bindPopup("<p>" + markerCreatedByClickCreated.get('nom') + "Commentaire : " + markerCreatedByClickCreated.get('description') + "</p>", { minWidth: 256 }, );
                           
                            closeModal()
                            editmap()
                            
                            
                        },
                        (error) => {console.error(error)
                        });

                    }

                    function closeModal() {
                        console.log('3')
                        var modal = document.getElementsByClassName('add-marker-modal')[0];
                        var classBefore = modal.getAttribute('class');
                        var classAfter = classBefore.substring(
                            0,
                            classBefore.indexOf('is-active')
                        );
                        modal.setAttribute('class', classAfter);
                    }
                    var modalCloseButton = document.getElementsByClassName('modal-close')[0];
                    modalCloseButton.addEventListener('click', closeModal)
                    var modalCancelButton = document.getElementsByClassName('is-text')[0];
                    modalCancelButton.addEventListener('click', closeModal)

                    
                    
                function editmap (){

                    
                        var editbutton = document.getElementById('switch');
                        console.log('yessai');
                        var classBefore = editbutton.getAttribute('class');
                        if (classBefore.includes('activated')){
                            var classAfter = classBefore.substring(
                            0,
                            classBefore.indexOf('activated')
                            );
                            editbutton.setAttribute('class', classAfter);
                        } else {
                            var classAfter = classBefore + ' activated';
                            editbutton.setAttribute('class', classAfter);
                        }
                        console.log('okay');


                }
                var editbutton = document.getElementById('switch');
                    editbutton.addEventListener('click', editmap);



                    function openModal(e) {

                        var editbutton = document.getElementById('switch');
                        console.log('yessai');
                        var classBefore = editbutton.getAttribute('class');
                        if (!classBefore.includes('activated')){
                            return
                        }


                        lastClickedCoordinates = e.latlng;
                        var modal = document.getElementsByClassName('add-marker-modal')[0];
                        var classBefore = modal.getAttribute('class');
                        var classAfter = classBefore + ' is-active';
                        modal.setAttribute('class', classAfter);

                        var addMarkerButton = document.getElementsByClassName('add-marker')[0];
                        addMarkerButton.addEventListener('click', addMarker);
                       
                    }

                    mymap.on('click', openModal);

                    function openModalUser () {

            
                        var modal = document.getElementsByClassName('user-modal')[0];
                        var classBefore = modal.getAttribute('class');
                        var classAfter = classBefore + ' is-active';
                        modal.setAttribute('class', classAfter);

                        var addUserButton = document.getElementsByClassName('submituser')[0];
                        addUserButton.addEventListener('click', addUser);

                        
                       
                    }

                    var addModalUser = document.getElementsByClassName('signup')[0];
                        addModalUser.addEventListener('click', openModalUser);





                    function closeModalUser() {
                        console.log('3')
                        var modal = document.getElementsByClassName('user-modal')[0];
                        var classBefore = modal.getAttribute('class');
                        var classAfter = classBefore.substring(
                            0,
                            classBefore.indexOf('is-active')
                        );
                        modal.setAttribute('class', classAfter);
                        console.log('ça marche')
                    }

                    var modalUserCloseButton = document.getElementsByClassName('closebutton-user')[0];
                    modalUserCloseButton.addEventListener('click', closeModalUser);
                    
                    
                    


                    function addUser() {
                        console.log('USER')
                        var userNameElement = document.getElementsByClassName('user-name')[0];
                        var userName = userNameElement.value;
                        userNameElement.value="";
                        console.log(userName)

                        var userEmailElement = document.getElementsByClassName('user-email')[0];
                        var userEmail = userEmailElement.value;
                        userEmailElement.value="";
                        console.log(userEmail)

                        var userPasswordElement = document.getElementsByClassName('user-password')[0];
                        var userPassword = userPasswordElement.value;
                        userPasswordElement.value="";
                        console.log(userPassword)

                        
                        var user = new Parse.User();
                        user.set("username", userName);
                        user.set("password", userPassword);
                        user.set("email", userEmail);


                        user.signUp(null, {
                        success: function(user) {
                            console.log('User created successful with name: ' + user.get("username") + ' and email: ' + user.get("email"));
                        },
                        error: function(user, error) {
                            // Show the error message somewhere and let the user try again.
                            // It is likely that the user is trying to sign with a username or email already taken.
                            console.log("Error: " + error.code + " " + error.message);
                        }
                        });


                        closeModalUser()
                        

                    }
                
                    

                  function logOut(){

                        Parse.User.logOut();
                        loggedOut();
                        console.log("logged out man");


                  }
                  var logoutButton = document.getElementsByClassName('logout')[0];
                    logoutButton.addEventListener('click', logOut);

                    function loggedOut () {


                        var showbuttonsignup = document.getElementsByClassName('signup')[0];
                        var classBefore = showbuttonsignup.getAttribute('class');
                        var classAfter = classBefore - ' hidden'+' button' + ' is-light' + ' is-outlined' + ' is-active' + ' signup';
                            showbuttonsignup.setAttribute('class', classAfter);
                            console.log("bouton signup remis");

                        var showbuttonlogin = document.getElementsByClassName('login')[0];
                        var classBefore2 = showbuttonlogin.getAttribute('class');
                        var classAfter2 = classBefore2 - ' hidden' + ' button' + ' is-link' + ' login';
                            showbuttonlogin.setAttribute('class', classAfter2);
                            console.log("bouton login remis")

                        var hideWelcomeButton = document.getElementsByClassName('welcome')[0];
                        var classBefore3 = hideWelcomeButton.getAttribute('class');
                        var classAfter3 = classBefore3 + ' hidden';
                            hideWelcomeButton.setAttribute('class', classAfter3);
                            console.log('bouton welcome caché');

                        var hideLogoutButton = document.getElementsByClassName('logout')[0];
                        var classBefore4 = hideLogoutButton.getAttribute('class');
                        var classAfter4 = classBefore4 + ' hidden';
                            hideLogoutButton.setAttribute('class', classAfter4);

                        var hideswitch = document.getElementsByClassName('toggle-button')[0];
                        var classBefore47 = hideswitch.getAttribute('class');
                        var classAfter47 = classBefore47 + ' hidden';
                            hideswitch.setAttribute('class', classAfter47);
                            console.log('bouton switch caché');

                        var showSignIn = document.getElementsByClassName('signin')[0];
                        var classBefore48 = showSignIn.getAttribute('class');
                        var classAfter48 = classBefore48 - ' hidden' + ' signin';
                            showSignIn.setAttribute('class', classAfter48);
                            console.log('bouton signin mis');


                    }



                  

                function login() {

                        

                        var userNameLogElement = document.getElementsByClassName('user-name-login')[0];
                        var userNameLog = userNameLogElement.value;
                        userNameLogElement.value="";
                        
                        console.log('jai le nom');

                        var userPasswordLogElement = document.getElementsByClassName('user-password-login')[0];
                        var userPasswordLog = userPasswordLogElement.value;
                        userPasswordLogElement.value="";

                        
                        console.log(userPasswordLog);


                    Parse.User.logIn(userNameLog, userPasswordLog)
                        .then((logintry) => { 
                            loggedIn(),
                             closeModalLogin()
                                    
                        }, (error) => { console.log("Echec de login")
                                    // The object was not retrieved successfully.
                                    // error is a Parse.Error with an error code and message.
                                            }
                        );

                            


                        
                        
                }

                    var loginButton = document.getElementsByClassName('submitlogin')[0];
                    loginButton.addEventListener('click', login);

                    function loggedIn () {


                        console.log('jsuis dans loggedin')

                        
                        var hidebuttonsignup = document.getElementsByClassName('signup')[0];
                        var classBefore = hidebuttonsignup.getAttribute('class');
                        var classAfter = classBefore + ' hidden';
                            hidebuttonsignup.setAttribute('class', classAfter);
                            console.log("bouton signup caché");

                        var hidebuttonlogin = document.getElementsByClassName('login')[0];
                        var classBefore2 = hidebuttonlogin.getAttribute('class');
                        var classAfter2 = classBefore2 + ' hidden';
                            hidebuttonlogin.setAttribute('class', classAfter2);
                            console.log(loggedIn)

                        var currentUser = Parse.User.current();
                        var currentUserName = currentUser.get("username");
                        console.log(currentUserName);

                        var showWelcomeButton = document.getElementsByClassName('welcome')[0];
                        var classBefore3 = showWelcomeButton.getAttribute('class');
                        var classAfter3 = classBefore3 - ' hidden' + ' button' + ' is-success' + ' welcome';
                            showWelcomeButton.setAttribute('class', classAfter3);
                            showWelcomeButton.innerHTML = "Welcome " + currentUserName + " !";
                            console.log('prêt à montrer le welcomebutton');

                        var showWelcomeButton = document.getElementsByClassName('logout')[0];
                        var classBefore4 = showWelcomeButton.getAttribute('class');
                        var classAfter4 = classBefore4 - ' hidden' + ' button' + ' is-danger' + ' logout';
                            showWelcomeButton.setAttribute('class', classAfter4);

                        var showswitch = document.getElementsByClassName('toggle-button')[0];
                        var classBefore47 = showswitch.getAttribute('class');
                        var classAfter47 = classBefore47 - ' hidden' + ' button' + ' toggle-button';
                            showswitch.setAttribute('class', classAfter47);
                            console.log('bouton switch caché');

                        var hideSignIn = document.getElementsByClassName('signin')[0];
                        var classBefore48 = hideSignIn.getAttribute('class');
                        var classAfter48 = classBefore48 + ' hidden';
                            hideSignIn.setAttribute('class', classAfter48);
                            console.log('bouton signin enlevé');
                            
                        

                    };

                    






                    function openModalLogin () {

            
                        var modal = document.getElementsByClassName('login-modal')[0];
                        var classBefore = modal.getAttribute('class');
                        var classAfter = classBefore + ' is-active';
                        modal.setAttribute('class', classAfter);

                        var addUserButton = document.getElementsByClassName('submitlogin')[0];
                        addUserButton.addEventListener('click', login);
                    
                    }

                    var openLoginModal = document.getElementsByClassName('login')[0];
                        openLoginModal.addEventListener('click', openModalLogin);


                    function closeModalLogin() {
                    console.log('3')
                    var modal = document.getElementsByClassName('login-modal')[0];
                    var classBefore = modal.getAttribute('class');
                    var classAfter = classBefore.substring(
                        0,
                        classBefore.indexOf('is-active')
                    );
                    modal.setAttribute('class', classAfter);
                }

                var closeLoginModal = document.getElementsByClassName('closebutton-login')[0];
                    closeLoginModal.addEventListener('click', closeModalLogin);





                    

                    function handleParseError(err) {
                        switch (err.code) {
                            case Parse.Error.INVALID_SESSION_TOKEN:
                            Parse.User.logOut();
                             // If web browser, render a log in screen
                             // If Express.js, redirect the user to the log in route
                            break;

                             // Other Parse API errors that you want to explicitly handle
                        }
                        }

                        // For each API request, call the global error handler
                        query.find().then(function() {
                        
                        }, function(err) {
                        handleParseError(err);
                        });

                    






                        

        }


            </script>


        </div>



    </div>

<script>

    $(document).ready(function(pret){
        console.log("ready!");
        var markers =  document.getElementsByClassName("leaflet-marker-icon");
        console.log(markers.length)

    })
</script>

</body>










</html>